{"version":3,"sources":["../../../public/js/photo_upload.js"],"names":["$","document","ready","uploadFiles","formData","ajax","url","method","data","processData","contentType","xhr","XMLHttpRequest","upload","addEventListener","event","progressBar","lengthComputable","percent","loaded","total","width","removeClass","done","handleSuccess","fail","status","alert","length","html","i","img","publicPath","console","log","on","preventDefault","files","get","FormData","file","append","name"],"mappings":";;AACA;;AAEAA,EAAEC,QAAF,EAAYC,KAAZ,CAAkB,YAAW;AAC1B;;;;;AAKA,YAASC,WAAT,CAAqBC,QAArB,EAA+B;AAC5BJ,QAAEK,IAAF,CAAO;AACJC,cAAK,gBADD;AAEJC,iBAAQ,MAFJ;AAGJC,eAAMJ,QAHF;AAIJK,sBAAa,KAJT;AAKJC,sBAAa,KALT;AAMJC,cAAK,eAAY;AACd,gBAAIA,MAAM,IAAIC,cAAJ,EAAV;;AAEA;AACAD,gBAAIE,MAAJ,CAAWC,gBAAX,CAA4B,UAA5B,EAAwC,UAAUC,KAAV,EAAiB;AACtD,mBAAIC,cAAchB,EAAE,eAAF,CAAlB;;AAEA,mBAAIe,MAAME,gBAAV,EAA4B;AACzB,sBAAIC,UAAWH,MAAMI,MAAN,GAAeJ,MAAMK,KAAtB,GAA+B,GAA7C;AACAJ,8BAAYK,KAAZ,CAAkBH,UAAU,GAA5B;;AAEA,sBAAIA,YAAY,GAAhB,EAAqB;AAClBF,iCAAYM,WAAZ,CAAwB,QAAxB;AACF;AACH;AACH,aAXD;;AAaA,mBAAOX,GAAP;AACF;AAxBG,OAAP,EAyBGY,IAzBH,CAyBQC,aAzBR,EAyBuBC,IAzBvB,CAyB4B,UAAUd,GAAV,EAAee,MAAf,EAAuB;AAChDC,eAAMD,MAAN;AACF,OA3BD;AA4BF;;AAED;;;;;AAKA,YAASF,aAAT,CAAuBhB,IAAvB,EAA6B;AAC1B,UAAIA,KAAKoB,MAAL,GAAc,CAAlB,EAAqB;AAClB,aAAIC,OAAO,EAAX;AACA,cAAK,IAAIC,IAAE,CAAX,EAAcA,IAAItB,KAAKoB,MAAvB,EAA+BE,GAA/B,EAAoC;AACjC,gBAAIC,MAAMvB,KAAKsB,CAAL,CAAV;;AAEA;AACA;AACGD,oBAAQ,QAAQE,IAAIC,UAAZ,GAAyB,MAAjC;AACH;AACA;AACA;AACA;AACF;AACD;AACAhC,WAAE,QAAF,EAAY6B,IAAZ,CAAiBA,IAAjB;AACF,OAfD,MAeO;AACJF,eAAM,0BAAN;AACF;AACDM,cAAQC,GAAR,CAAYH,IAAIC,UAAhB;AACF;;AAEJ;AACGhC,KAAE,eAAF,EAAmBmC,EAAnB,CAAsB,QAAtB,EAAgC,YAAY;AACzCnC,QAAE,eAAF,EAAmBqB,KAAnB,CAAyB,IAAzB;AACF,IAFD;;AAIH;AACGrB,KAAE,gBAAF,EAAoBmC,EAApB,CAAuB,QAAvB,EAAiC,UAAUpB,KAAV,EAAiB;AAC/CA,YAAMqB,cAAN;;AAEA;AACA,UAAIC,QAAQrC,EAAE,eAAF,EAAmBsC,GAAnB,CAAuB,CAAvB,EAA0BD,KAAtC;AAAA,UACIjC,WAAW,IAAImC,QAAJ,EADf;;AAGA,UAAIF,MAAMT,MAAN,KAAiB,CAArB,EAAwB;AACrBD,eAAM,kCAAN;AACA,gBAAO,KAAP;AACF;;AAED,UAAIU,MAAMT,MAAN,GAAe,CAAnB,EAAsB;AACnBD,eAAM,oCAAN;AACA,gBAAO,KAAP;AACF;;AAED;AACA,WAAK,IAAIG,IAAE,CAAX,EAAcA,IAAIO,MAAMT,MAAxB,EAAgCE,GAAhC,EAAqC;AAClC,aAAIU,OAAOH,MAAMP,CAAN,CAAX;AACA1B,kBAASqC,MAAT,CAAgB,UAAhB,EAA4BD,IAA5B,EAAkCA,KAAKE,IAAvC;AACF;;AAED;AACAvC,kBAAYC,QAAZ;AACF,IAzBD;AA2BF,CAjGD","file":"photo_upload.js","sourcesContent":["\n// ====================================\n\n$(document).ready(function() {\n   /**\n    * Upload the photos using ajax request.\n    *\n    * @param formData\n    */\n   function uploadFiles(formData) {\n      $.ajax({\n         url: '/upload_photos',\n         method: 'post',\n         data: formData,\n         processData: false,\n         contentType: false,\n         xhr: function () {\n            var xhr = new XMLHttpRequest();\n\n            // Add progress event listener to the upload.\n            xhr.upload.addEventListener('progress', function (event) {\n               var progressBar = $('.progress-bar');\n\n               if (event.lengthComputable) {\n                  var percent = (event.loaded / event.total) * 100;\n                  progressBar.width(percent + '%');\n\n                  if (percent === 100) {\n                     progressBar.removeClass('active');\n                  }\n               }\n            });\n\n            return xhr;\n         }\n      }).done(handleSuccess).fail(function (xhr, status) {\n         alert(status);\n      });\n   }\n\n   /**\n    * Handle the upload response data from server and display them.\n    *\n    * @param data\n    */\n   function handleSuccess(data) {\n      if (data.length > 0) {\n         var html = '';\n         for (var i=0; i < data.length; i++) {\n            var img = data[i];\n      \n            // if (img.status) {\n            //    console.log(img.publicPath);\n               html += '<p>' + img.publicPath + '</p>';\n            // } else {\n            //     console.log(img.publicPath)\n            //    html += '<div class=\"col-xs-6 col-md-4\"><a href=\"#\" class=\"thumbnail\">Invalid file type - ' + img.filename  + '</a></div>';\n            // }\n         }\n         // console.log(html)\n         $('#album').html(html);\n      } else {\n         alert('No images were uploaded.')\n      }\n      console.log(img.publicPath);\n   }\n\n// Set the progress bar to 0 when a file(s) is selected.\n   $('#photos-input').on('change', function () {\n      $('.progress-bar').width('0%');\n   });\n\n// On form submit, handle the file uploads.\n   $('#upload-photos').on('submit', function (event) {\n      event.preventDefault();\n\n      // Get the files from input, create new FormData.\n      var files = $('#photos-input').get(0).files,\n          formData = new FormData();\n\n      if (files.length === 0) {\n         alert('Select atleast 1 file to upload.');\n         return false;\n      }\n\n      if (files.length > 3) {\n         alert('You can only upload up to 3 files.');\n         return false;\n      }\n\n      // Append the files to the formData.\n      for (var i=0; i < files.length; i++) {\n         var file = files[i];\n         formData.append('photos[]', file, file.name);\n      }\n\n      // Note: We are only appending the file inputs to the FormData.\n      uploadFiles(formData);\n   });\n\n});\n"]}