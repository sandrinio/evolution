{"version":3,"sources":["../../routes/auth.js"],"names":["express","require","router","Router","User","passport","middleware","get","req","res","flash","render","post","body","password","repassword","userInfo","user","pic","register","err","redirect","authenticate","failureRedirect","failureFlash","firstname","logout","module","exports"],"mappings":";;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,SAASF,QAAQG,MAAR,EAAb;AACA,IAAIC,OAAOH,QAAQ,gBAAR,CAAX;AACA,IAAII,WAAWJ,QAAQ,UAAR,CAAf;AACA,IAAIK,aAAaL,QAAQ,eAAR,CAAjB;;AAGAC,OAAOK,GAAP,CAAW,GAAX,EAAgB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACjCD,MAAIE,KAAJ,CAAU,SAAV,EAAqB,OAArB;AACDD,MAAIE,MAAJ,CAAW,YAAX;AACD,CAHD;;AAKAT,OAAOK,GAAP,CAAW,WAAX,EAAwB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AAC1CA,MAAIE,MAAJ,CAAW,eAAX;AACD,CAFD;;AAIAT,OAAOU,IAAP,CAAY,WAAZ,EAAyB,UAAUJ,GAAV,EAAeC,GAAf,EAAoB;AAC3C,MAAGD,IAAIK,IAAJ,CAASC,QAAT,KAAsBN,IAAIK,IAAJ,CAASE,UAAlC,EAA8C;AAC5C,QAAIC,WAAWR,IAAIK,IAAJ,CAASI,IAAxB;AACAD,aAASE,GAAT,GAAe,YAAf;AACAd,SAAKe,QAAL,CAAcH,QAAd,EAAwBR,IAAIK,IAAJ,CAASC,QAAjC,EAA2C,UAAUM,GAAV,EAAeH,IAAf,EAAqB;AAC9D,UAAGG,GAAH,EAAO;AACLZ,YAAIE,KAAJ,CAAU,OAAV,EAAmBU,GAAnB;AACD,OAFD,MAEK;AACHX,YAAIY,QAAJ,CAAa,eAAb;AACD;AACF,KAND;AAOD,GAVD,MAUK;AACHZ,QAAIC,KAAJ,CAAU,OAAV,EAAmB,eAAnB;AACD;AACF,CAdD;;AAgBAR,OAAOU,IAAP,CAAY,QAAZ,EAAsBP,SAASiB,YAAT,CAAsB,OAAtB,EAA+B;AACnD;AACCC,mBAAiB,GAFiC;AAGlDC,gBAAe;AAHmC,CAA/B,CAAtB,EAII,UAAUhB,GAAV,EAAeC,GAAf,EAAoB;AACtBD,MAAIE,KAAJ,CAAU,SAAV,EAAqB,aAAaF,IAAIS,IAAJ,CAASQ,SAAtB,GAAkC,MAAvD;AACAhB,MAAIY,QAAJ,CAAa,eAAb;AACD,CAPD;;AASAnB,OAAOK,GAAP,CAAW,SAAX,EAAsB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACxCD,MAAIkB,MAAJ;AACAlB,MAAIE,KAAJ,CAAU,SAAV,EAAqB,YAArB;AACAD,MAAIY,QAAJ,CAAa,GAAb;AACD,CAJD;;AAMAM,OAAOC,OAAP,GAAiB1B,MAAjB","file":"auth.js","sourcesContent":["var express = require('express');\nvar router = express.Router();\nvar User = require('../models/user');\nvar passport = require(\"passport\");\nvar middleware = require(\"../middleware\");\n\n\nrouter.get('/', function (req, res) {\n   req.flash('success', 'hello');\n  res.render('auth/login')\n});\n\nrouter.get('/register', function (req, res) {\n  res.render('auth/register')\n});\n\nrouter.post('/register', function (req, res) {\n  if(req.body.password === req.body.repassword) {\n    var userInfo = req.body.user;\n    userInfo.pic = 'avatar.jpg'\n    User.register(userInfo, req.body.password, function (err, user) {\n      if(err){\n        req.flash('error', err)\n      }else{\n        res.redirect('/instructions')\n      }\n    })\n  }else{\n    res.flash('error', 'Password Typo')\n  }\n});\n\nrouter.post(\"/login\", passport.authenticate(\"local\", {\n  // successRedirect: \"/instructions\",\n   failureRedirect: \"/\",\n   failureFlash : true\n}), function (req, res) {\n  req.flash(\"success\", 'Welcome ' + req.user.firstname + \"  :)\");\n  res.redirect(\"/instructions\");\n});\n\nrouter.get(\"/logout\", function (req, res) {\n  req.logout();\n  req.flash(\"success\", \"Logged Out\");\n  res.redirect(\"/\");\n});\n\nmodule.exports = router;"]}