{"version":3,"sources":["../../routes/requests.js"],"names":["express","require","router","Router","middleware","Post","mailer","get","isLoggedIn","req","res","find","sort","exec","err","reqsContent","console","log","render","page_name","findById","params","id","result","flash","put","obj","body","nPost","status","findByIdAndUpdate","redirect","module","exports"],"mappings":";;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,SAASF,QAAQG,MAAR,EAAb;AACA,IAAIC,aAAaH,QAAQ,eAAR,CAAjB;AACA,IAAII,OAAOJ,QAAQ,gBAAR,CAAX;AACA,IAAIK,SAASL,QAAQ,qBAAR,CAAb;;AAEAC,OAAOK,GAAP,CAAW,UAAX,EAAuBH,WAAWI,UAAlC,EAA8C,UAACC,GAAD,EAAMC,GAAN,EAAc;AACxDL,QAAKM,IAAL,CAAU,EAAC,UAAU,MAAM,UAAN,IAAoB,WAA/B,EAAV,EAAuDC,IAAvD,CAA4D,OAA5D,EAAqEC,IAArE,CAA0E,UAAUC,GAAV,EAAeC,WAAf,EAA2B;AACjG,UAAGD,GAAH,EAAO;AACH,gBAAOE,QAAQC,GAAR,CAAYH,GAAZ,CAAP;AACH;;AAEGJ,UAAIQ,MAAJ,CAAW,eAAX,EAA4B;AACzBC,oBAAW,MADc;AAEzBJ,sBAAaA;AAFY,OAA5B;AAIP,IATD;AAUH,CAXD;;AAcAb,OAAOK,GAAP,CAAW,gBAAX,EAA6B,UAAUE,GAAV,EAAeC,GAAf,EAAoB;AAC9CL,QAAKe,QAAL,CAAcX,IAAIY,MAAJ,CAAWC,EAAzB,EAA6B,UAAUR,GAAV,EAAeS,MAAf,EAAuB;AACjD,UAAGT,GAAH,EAAO;AACJL,aAAIe,KAAJ,CAAU,OAAV,EAAmBV,GAAnB;AACAE,iBAAQC,GAAR,CAAYH,GAAZ;AACF,OAHD,MAGK;AACFJ,aAAIQ,MAAJ,CAAW,eAAX,EAA4B;AACzBK,oBAAQA,MADiB;AAEzBJ,uBAAW;AAFc,UAA5B;AAIF;AACH,IAVD;AAYF,CAbD;;AAeAjB,OAAOuB,GAAP,CAAW,mBAAX,EAAgC,UAAUhB,GAAV,EAAeC,GAAf,EAAoB;AACjD,OAAIgB,MAAMjB,IAAIkB,IAAJ,CAASC,KAAnB;AACAF,OAAIG,MAAJ,GAAapB,IAAIkB,IAAJ,CAASE,MAAtB;AACAxB,QAAKyB,iBAAL,CAAuBrB,IAAIY,MAAJ,CAAWC,EAAlC,EAAsCI,GAAtC,EAA2C,UAAUZ,GAAV,EAAeS,MAAf,EAAuB;AAC/D,UAAGT,GAAH,EAAO;AACJE,iBAAQC,GAAR,CAAYH,GAAZ;AACF,OAFD,MAEK;AACFJ,aAAIqB,QAAJ,CAAa,gBAAgBtB,IAAIY,MAAJ,CAAWC,EAAxC;AACF;AACH,IAND;AAOF,CAVD;;AAYAU,OAAOC,OAAP,GAAiB/B,MAAjB","file":"requests.js","sourcesContent":["var express = require('express');\nvar router = express.Router();\nvar middleware = require('../middleware');\nlet Post = require('../models/post');\nvar mailer = require('../middleware/mails');\n\nrouter.get('/request', middleware.isLoggedIn, (req, res) => {\n    Post.find({'status': '' || 'Unsolved' || 'undefined'}).sort('-date').exec(function (err, reqsContent){\n        if(err){\n            return console.log(err)\n        }\n    \n            res.render('requests/reqs', {\n               page_name: 'reqs',\n               reqsContent: reqsContent\n            });\n    });\n});\n\n\nrouter.get('/post/:id/edit', function (req, res) {\n   Post.findById(req.params.id, function (err, result) {\n      if(err){\n         req.flash('Error', err);\n         console.log(err)\n      }else{\n         res.render('requests/edit', {\n            result: result,\n            page_name: 'none'\n         })\n      }\n   })\n\n});\n\nrouter.put('/request/:id/edit', function (req, res) {\n   let obj = req.body.nPost;\n   obj.status = req.body.status;\n   Post.findByIdAndUpdate(req.params.id, obj, function (err, result) {\n      if(err){\n         console.log(err)\n      }else{\n         res.redirect('/home/show/' + req.params.id)\n      }\n   })\n});\n\nmodule.exports = router;"]}