{"version":3,"sources":["../../middleware/index.js"],"names":["middlewareObject","permissionChecker","req","res","next","isAuthenticated","user","permission","flash","redirect","isLoggedIn","module","exports"],"mappings":";;AAAA,IAAIA,mBAAmB,EAAvB;;AAEAA,iBAAiBC,iBAAjB,GAAqC,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC7D,MAAGF,IAAIG,eAAJ,MAAyBH,IAAII,IAAJ,CAASC,UAAT,KAAwB,OAApD,EAA4D;AAC1DH;AACD,GAFD,MAEO;AACLF,QAAIM,KAAJ,CAAU,OAAV,EAAmB,eAAnB;AACAL,QAAIM,QAAJ,CAAa,MAAb;AACD;AACF,CAPD;;AAUAT,iBAAiBU,UAAjB,GAA8B,UAAUR,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACtD,MAAIF,IAAIG,eAAJ,EAAJ,EAA2B;AACzB,WAAOD,MAAP;AACD,GAFD,MAEK;AACHF,QAAIM,KAAJ,CAAU,OAAV,EAAmB,0BAAnB;AACAL,QAAIM,QAAJ,CAAa,GAAb;AACD;AACF,CAPD;;AAUAE,OAAOC,OAAP,GAAiBZ,gBAAjB","file":"index.js","sourcesContent":["let middlewareObject = {};\n\nmiddlewareObject.permissionChecker = function (req, res, next) {\n  if(req.isAuthenticated() && req.user.permission === \"Admin\"){\n    next();\n  } else {\n    req.flash(\"error\", \"No permission\");\n    res.redirect(\"back\");\n  }\n};\n\n\nmiddlewareObject.isLoggedIn = function (req, res, next) {\n  if (req.isAuthenticated()) {\n    return next();\n  }else{\n    req.flash('error', 'You have to be logged in');\n    res.redirect(\"/\")\n  }\n};\n\n\nmodule.exports = middlewareObject;"]}